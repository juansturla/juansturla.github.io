<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>StreamTheDots</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="unity-webview.js"></script>
</head>
  <body>
    <div id="unity-container" class="unity-desktop">
      <a>The game needs your Twitch permission to run</a>
      <br />
      <a>We only need permissions to read the chat</a>
      <br />
      <br />
      <button type="button"
              id="connectToTwitchButton"
              class="btn btn-twitch"
              onclick="window.location='https://id.twitch.tv/oauth2/authorize?response_type=token&client_id=r4htw0tkj8vjq4gaqod6dgmz8apuw1&redirect_uri=http%3A%2F%2Flocalhost%3A58414%2F&scope=&chat:read';"
              >
          <i class="fa fa-1x fa-twitch"></i> Connect with Twitch
      </button>

      <script>
          const twitchLinkButton = document.getElementById('connectToTwitchButton');
          var queryString = window.location.hash;
          window.location.
              queryString = queryString.replace('#', '&');
          const urlParams = new URLSearchParams(queryString);
          if (urlParams.has('access_token')) {
              window.location = window.location.hostname;
          }
          else {
              twitchLinkButton.setAttribute
                  (
                      "onclick",
                      "window.location='"+
                      "https://id.twitch.tv/oauth2/authorize" +
                      "?response_type=token" +
                      "&client_id=r4htw0tkj8vjq4gaqod6dgmz8apuw1" +
                      "&force_verify=true" +
                      "&redirect_uri=" +
                      encodeURIComponent(window.location.origin) + "/" +
                      "&scope=chat:read'"
                  );
          }</script>
        </div>
  </body>
</html>
